<?xml version="1.0" encoding="utf-8"?>

<layout xmlns:tools="http://schemas.android.com/tools"
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"

    >

    <!--    android:backgroundTint="@color/selector_item"-->

    <data>
        <variable
            name="viewModel"
            type="com.schedule.model.TaskModel" />
        <import type="android.view.View"/>
        <import type="com.schedule.Task"/>
        <import type="com.schedule.Task.TimeOfDay"/>
        <import type = "androidx.core.content.ContextCompat" />
    </data>

    <!--    app:cardCornerRadius="@dimen/select_card_corner_radius"-->
    <!--    app:cardElevation="@dimen/select_card_elevation"-->
    <!--    android:layout_margin="@dimen/select_card_margin"-->

    <androidx.cardview.widget.CardView
        android:id="@+id/cardView"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:animateLayoutChanges="true"
        app:selected="@{viewModel.isSelected}"
        android:backgroundTint="@color/selector_item"
        app:cardElevation="0dp"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toTopOf="parent">

        <androidx.constraintlayout.widget.ConstraintLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"

            android:paddingTop="8dp"
            android:paddingBottom="8dp">


            <View
                android:layout_width="match_parent"
                android:layout_height="1dp"
                android:background="@color/gray"
                android:visibility="@{viewModel.isExpanded ? View.VISIBLE : View.GONE}"

                app:layout_constraintEnd_toEndOf="parent"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toTopOf="parent" />

            <TextView
                android:id="@+id/textViewTime"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@{viewModel.time}"
                android:textColor="@{ContextCompat.getColor(context, viewModel.timeColor)}"
                android:textSize="28dp"
                app:layout_constraintBottom_toTopOf="@+id/textViewAdditional"
                app:layout_constraintEnd_toStartOf="@+id/guideline2"
                app:layout_constraintHorizontal_bias="0.0"
                app:layout_constraintStart_toStartOf="@+id/guideline5"
                app:layout_constraintTop_toTopOf="parent"
                app:layout_constraintVertical_bias="0.0"
                app:layout_constraintVertical_chainStyle="packed" />

            <TextView
                android:id="@+id/textViewAdditional"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@{viewModel.additionalText}"
                app:layout_constraintBottom_toBottomOf="parent"
                app:layout_constraintEnd_toStartOf="@+id/guideline2"
                app:layout_constraintHorizontal_bias="0.0"
                app:layout_constraintStart_toStartOf="@+id/guideline5"
                app:layout_constraintTop_toBottomOf="@+id/textViewTime" />


            <androidx.appcompat.widget.SwitchCompat
                android:id="@+id/switchEnable"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:checked="@{viewModel.isEnable}"
                android:visibility="@{viewModel.isSelected ? View.GONE : View.VISIBLE}"

                android:thumb="@drawable/switch_thumb_selector"
                app:track="@drawable/switch_track_selector"
                app:layout_constraintBottom_toBottomOf="@+id/textViewAdditional"
                app:layout_constraintEnd_toStartOf="@+id/guideline2"
                app:layout_constraintHorizontal_bias="1.0"
                app:layout_constraintStart_toStartOf="@+id/guideline5"
                app:layout_constraintTop_toTopOf="parent"
                app:layout_constraintVertical_bias="0.2"
                app:onCheckedChange="@{(buttonView, isChecked) -> viewModel.onEnabledChanged(isChecked)}" />

            <androidx.constraintlayout.widget.Guideline
                android:id="@+id/guideline2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="vertical"
                app:layout_constraintGuide_percent="0.95" />

            <androidx.constraintlayout.widget.Guideline
                android:id="@+id/guideline5"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="vertical"
                app:layout_constraintGuide_percent="0.05" />

            <!--        app:initValue="@{viewModel.item.timeOfDay.getValue()}"-->

            <com.schedule.tools.TimePicker
                android:id="@+id/timePicker2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:visibility="@{viewModel.isExpanded ? View.VISIBLE : View.GONE}"
                app:initValue="@{viewModel.item.timeOfDay}"
                app:initValueMode="value"
                app:layout_constraintBottom_toTopOf="@+id/chipGroup2"
                app:layout_constraintEnd_toStartOf="@+id/guideline2"
                app:layout_constraintStart_toStartOf="@+id/guideline5"
                app:layout_constraintTop_toBottomOf="@+id/textViewAdditional"
                app:onTimeChanged="@{(view, hour, minute) -> viewModel.onNumChange(hour, minute)}" />

            <View
                android:layout_width="match_parent"
                android:layout_height="1dp"
                android:background="@color/gray"
                android:visibility="@{viewModel.isExpanded ? View.VISIBLE : View.GONE}"
                app:layout_constraintBottom_toBottomOf="parent"
                app:layout_constraintEnd_toEndOf="parent"
                app:layout_constraintStart_toStartOf="parent" />

            <com.google.android.material.chip.ChipGroup
                android:id="@+id/chipGroup2"
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:duplicateParentState="false"

                android:padding="10dp"
                android:visibility="@{viewModel.isExpanded ? View.VISIBLE : View.GONE}"
                app:chipSpacingHorizontal="6dp"
                app:layout_constraintBottom_toTopOf="@+id/switchRepeat"
                app:layout_constraintEnd_toEndOf="parent"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@+id/timePicker2"
                app:selectionRequired="true"
                app:singleLine="false">

                <com.google.android.material.chip.Chip
                    style="@style/Widget.MaterialComponents.Chip.Choice"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:checked="@={viewModel.stateMonday}"
                    android:duplicateParentState="false"
                    android:focusableInTouchMode="false"
                    android:onClick="@{() -> viewModel.onSelectDaysGroupPressed()}"
                    android:text="@string/schedule_repeat_monday_s" />

                <com.google.android.material.chip.Chip
                    style="@style/Widget.MaterialComponents.Chip.Choice"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:checked="@={viewModel.stateTuesday}"
                    android:duplicateParentState="false"
                    android:onClick="@{() -> viewModel.onSelectDaysGroupPressed()}"
                    android:text="@string/schedule_repeat_tuesday_s" />

                <com.google.android.material.chip.Chip
                    style="@style/Widget.MaterialComponents.Chip.Choice"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:checked="@={viewModel.stateWednesday}"
                    android:duplicateParentState="false"
                    android:onClick="@{() -> viewModel.onSelectDaysGroupPressed()}"
                    android:text="@string/schedule_repeat_wednesday_s" />

                <com.google.android.material.chip.Chip
                    style="@style/Widget.MaterialComponents.Chip.Choice"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:checked="@={viewModel.stateThursday}"
                    android:duplicateParentState="false"
                    android:onClick="@{() -> viewModel.onSelectDaysGroupPressed()}"
                    android:text="@string/schedule_repeat_thursday_s" />

                <com.google.android.material.chip.Chip
                    style="@style/Widget.MaterialComponents.Chip.Choice"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:checked="@={viewModel.stateFriday}"
                    android:duplicateParentState="false"
                    android:onClick="@{() -> viewModel.onSelectDaysGroupPressed()}"
                    android:text="@string/schedule_repeat_friday_s" />

                <com.google.android.material.chip.Chip
                    style="@style/Widget.MaterialComponents.Chip.Choice"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:checked="@={viewModel.stateSaturday}"
                    android:duplicateParentState="false"
                    android:onClick="@{() -> viewModel.onSelectDaysGroupPressed()}"
                    android:text="@string/schedule_repeat_saturday_s" />

                <com.google.android.material.chip.Chip
                    style="@style/Widget.MaterialComponents.Chip.Choice"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:checked="@={viewModel.stateSunday}"
                    android:duplicateParentState="false"
                    android:onClick="@{() -> viewModel.onSelectDaysGroupPressed()}"
                    android:text="@string/schedule_repeat_sunday_s" />

            </com.google.android.material.chip.ChipGroup>

            <androidx.appcompat.widget.SwitchCompat
                android:id="@+id/switchRepeat"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:checked="@{viewModel.item.repeat}"
                android:text="@string/schedule_edit_switch_repeat"
                android:textSize="18sp"
                app:track="@drawable/switch_track_selector"
                android:thumb="@drawable/switch_repeat_thumb_selector"

                android:visibility="@{viewModel.isExpanded ? View.VISIBLE : View.GONE}"
                app:layout_constraintBottom_toTopOf="@+id/guideline3"
                app:layout_constraintEnd_toEndOf="parent"
                app:layout_constraintHorizontal_bias="0.5"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@+id/chipGroup2"
                app:onCheckedChange="@{(buttonView, isChecked) -> viewModel.onRepeatChanged(isChecked)}" />

<!--            <CheckBox-->
<!--                android:id="@+id/radioButton"-->
<!--                android:layout_width="wrap_content"-->
<!--                android:layout_height="wrap_content"-->
<!--                android:clickable="true"-->
<!--                android:focusable="true"-->
<!--                android:visibility="@{viewModel.isSelected ? View.VISIBLE : View.GONE}"-->
<!--                app:layout_constraintBottom_toBottomOf="@+id/textViewAdditional"-->
<!--                app:layout_constraintEnd_toStartOf="@+id/guideline2"-->
<!--                app:layout_constraintHorizontal_bias="1.0"-->
<!--                app:layout_constraintStart_toStartOf="@+id/guideline5"-->
<!--                app:layout_constraintTop_toTopOf="parent"-->
<!--                app:layout_constraintVertical_bias="0.2"-->
<!--                 />-->


        </androidx.constraintlayout.widget.ConstraintLayout>

    </androidx.cardview.widget.CardView>

</layout>